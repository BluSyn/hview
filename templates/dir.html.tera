<!doctype html>
<html>
<head>
    <title>{{title}}</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAGFBMVEUAAACAgIDAwMAAAAD//////wAAAP+AgACyGYBKAAAAAXRSTlMAQObYZgAAAAFiS0dEBI9o2VEAAAAHdElNRQfiBhgXAzXpQrjsAAAArklEQVQoz3WQQQ7CIBBF4QbS4gEsYV8DHkAc3Rev0Buw8PoOQ9KZjPGlm76+hE+N+cdJvdughC+r+OqcAxCJB8CHE1vqBiASH6OHFycj2NEE50g8KdgxybBSMQI0oTYqKOim3EjcR9BNQGGnhSmJVh08PG45R+aScctUmS3jXFlEXdRroKHMnOgqzNxUQcNk8W7jd/CQ1IUcklSx6KImo45pRh1D4iPowiTBan74AnnnVMHA9EjhAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTA2LTI0VDIzOjAzOjUzLTA0OjAwyUvdTwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0wNi0yNFQyMzowMzo1My0wNDowMLgWZfMAAAAASUVORK5CYII=" rel="icon" type="image/png" />

    <style type="text/css">
    body {
      color: #dfe6e9;
      background-color: #2d3436;
      font-size: 1.5em;
      font-family: Helvetica, Arial, sans-serif;
      overflow-x: hidden;
    }
    a {
      color: #dfe6e9;
      text-decoration: none;
      background-color: transparent !important;
      outline: 0;
    }

    h1 {
      display: inline-block;
      margin: 20px 0;
      word-wrap: break-word;
      width: 80%;
      margin-bottom: 28px;
      cursor: pointer;
    }
    h1 > span:hover {
      color: #f1c40f;
    }
    </style>

    <script type="text/javascript">
    const imgModal = document.getElementById("img_modal");
    const imgTypes = ['.jpg', '.jpeg', '.jpe', '.png', '.gif', '.avif', '.webp', '.heic'];
    const isImg = src => src && picTypes.find(type => src.toLocaleLowerCase().includes(type));
    const vidModal = document.getElementById("vid_modal");
    const videosTypes = ['.mp4', '.webm', '.mts', '.mov', '.ogv', '.ogg', '.mp3', '.flac', '.wav'];
    const isVideo = src => src && videosTypes.find(type => src.toLocaleLowerCase().includes(type));

    const gotoFile = function(e) {
        const file = e.pathname;
        if (isImg(file)) {
            showImg(file);
            return false;
        }
        if (isVideo(file)) {
            showVideo(file);
            return false;
        }

        return true;
    };
    const gotoFolder = function(e) {
        return true;
    };

    const showImg = function(file) {
        imgModal.style.display = "block";
        imgModal.firstChild.src = file;
    };
    const showVid = function(file) {
        vidModal.style.display = "block";
        vidModal.firstChild.src = file;
    };

    const setTitle = function(title) {
        title.innerHTML = '<span>' + title.innerText.split('/').join('/</span><span>') + '</span>'
    };

    window.onload = function() {
        const title = document.getElementById('title');
        setTitle(title);
    }
    </script>
</head>
<body>
    <div id="img_modal" class="modal hidden"><img draggable="false" /></div>
    <div id="vid_modal" class="modal hidden"><video controls></video></div>

    <div class="container">
        <h1 id="title">{{title}}</h1>

        <div class="row gx-5">
        {% for folder in folders %}
            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 mb-sm-2 mb-lg-5 dir">
                {% if folder.thumb %} <a href="{{base_path}}{{folder.path}}"><img src="{{base_path}}{{folder.thumb}}" loading="lazy" /></a><br /> {% endif %}
                <a href="{{base_path}}{{folder.path}}"><i class="bi bi-folder-fill text-info"></i> <strong>{{folder.name}}</strong></a>
            </div>
        {% endfor %}
        {% for file in files %}
            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 mb-sm-2 mb-lg-5 file">
                {% if file.thumb %} <a href="{{base_path}}{{file.path}}"><img src="{{base_path}}{{file.thumb}}" loading="lazy" /></a><br /> {% endif %}
                <a href="{{base_path}}{{file.path}}"><i class="bi bi-file-richtext text-success"></i> <strong>{{file.name}}</strong></a><br />
                <small>{{file.size}} B</small> /
                <small><time datetime="{{file.date_string}}">{{file.date_string}}</time></small>
            </div>
        {% endfor %}
        </div>
    </div>
</body>
</html>
